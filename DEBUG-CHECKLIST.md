# æ‰“åŒ…åè°ƒè¯•æ£€æŸ¥æ¸…å•

## ğŸ” å¿«é€Ÿæ£€æŸ¥æ­¥éª¤

### 1. æ£€æŸ¥ WebSocket æœåŠ¡å™¨

**åœ¨ Electron æ§åˆ¶å°æŸ¥çœ‹ï¼š**
```
âœ… WebSocket æœåŠ¡å™¨å·²å¯åŠ¨: ws://127.0.0.1:8765/ws
âœ… å¥åº·æ£€æŸ¥: http://127.0.0.1:8765/health
ğŸ“¦ åº”ç”¨æ˜¯å¦æ‰“åŒ…: true
```

**åœ¨æµè§ˆå™¨æ§åˆ¶å°æµ‹è¯•ï¼š**
```javascript
fetch('http://127.0.0.1:8765/health')
  .then(r => r.json())
  .then(console.log)
```

### 2. æ£€æŸ¥ preload.js åŠ è½½

**åœ¨ Electron æ§åˆ¶å°æŸ¥çœ‹ï¼š**
```
ğŸ“ Preload è·¯å¾„: ...
ğŸ“ __dirname: ...
ğŸ“¦ æ˜¯å¦æ‰“åŒ…: true
```

**å¦‚æœæ²¡æœ‰ preload è·¯å¾„æ—¥å¿—ï¼Œè¯´æ˜ preload.js åŠ è½½å¤±è´¥**

### 3. æ£€æŸ¥ IPC é€šä¿¡

**åœ¨ Electron çª—å£çš„å¼€å‘è€…å·¥å…·æ§åˆ¶å°æŸ¥çœ‹ï¼š**
- åº”è¯¥çœ‹åˆ°ï¼š`âœ… Electron API å·²åŠ è½½`
- åº”è¯¥çœ‹åˆ°ï¼š`âœ… Electron API å¯ç”¨: {...}`

**å¦‚æœæ²¡æœ‰ï¼Œè¯´æ˜ preload.js æ²¡æœ‰æ­£ç¡®åŠ è½½**

### 4. æ£€æŸ¥æ¶ˆæ¯æ¥æ”¶

**å½“æµè§ˆå™¨å‘é€æ¶ˆæ¯æ—¶ï¼ŒElectron æ§åˆ¶å°åº”è¯¥æ˜¾ç¤ºï¼š**
```
ğŸ“¨ æ”¶åˆ°æµè§ˆå™¨æ¶ˆæ¯: {...}
ğŸ“¨ æ¶ˆæ¯æ•°æ®: {...}
ğŸ“¤ å‘é€æ¶ˆæ¯åˆ°æ¸²æŸ“è¿›ç¨‹ï¼ˆä»…ç”¨æˆ·æ•°æ®ï¼‰: {...}
ğŸ“¦ ä¸»çª—å£çŠ¶æ€: æ­£å¸¸
âœ… æ¶ˆæ¯å·²æˆåŠŸå‘é€åˆ°æ¸²æŸ“è¿›ç¨‹
```

**å¦‚æœçœ‹åˆ° `âš ï¸ ä¸»çª—å£ä¸å­˜åœ¨æˆ–å·²é”€æ¯`ï¼Œè¯´æ˜çª—å£æœ‰é—®é¢˜**

### 5. æ£€æŸ¥æ¸²æŸ“è¿›ç¨‹æ¥æ”¶

**åœ¨ Electron çª—å£çš„å¼€å‘è€…å·¥å…·æ§åˆ¶å°åº”è¯¥çœ‹åˆ°ï¼š**
```
ğŸ“¨ æ”¶åˆ°ä¸»è¿›ç¨‹æ¶ˆæ¯: {...}
```

## ğŸ› å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ

### é—®é¢˜ 1ï¼šWebSocket æœåŠ¡å™¨æœªå¯åŠ¨

**ç—‡çŠ¶**ï¼šæµè§ˆå™¨è¿æ¥å¤±è´¥

**è§£å†³**ï¼š
1. æ£€æŸ¥ Electron æ§åˆ¶å°æ˜¯å¦æœ‰é”™è¯¯
2. æ£€æŸ¥ç«¯å£æ˜¯å¦è¢«å ç”¨
3. æ£€æŸ¥é˜²ç«å¢™è®¾ç½®
4. å°è¯•æ‰‹åŠ¨è®¿é—® `http://127.0.0.1:8765/health`

### é—®é¢˜ 2ï¼špreload.js æœªåŠ è½½

**ç—‡çŠ¶**ï¼š`window.electronAPI` ä¸å­˜åœ¨

**è§£å†³**ï¼š
1. æ£€æŸ¥ `package.json` çš„ `files` é…ç½®
2. æ£€æŸ¥æ‰“åŒ…åçš„æ–‡ä»¶ç»“æ„
3. æ£€æŸ¥ preload è·¯å¾„æ˜¯å¦æ­£ç¡®
4. å¦‚æœä½¿ç”¨ asarï¼Œç¡®ä¿ `asar: false` æˆ–æ­£ç¡®é…ç½® `asarUnpack`

### é—®é¢˜ 3ï¼šæ¶ˆæ¯å‘é€ä½†çª—å£ä¸æ˜¾ç¤º

**ç—‡çŠ¶**ï¼šElectron æ§åˆ¶å°æ˜¾ç¤ºæ”¶åˆ°æ¶ˆæ¯ï¼Œä½†çª—å£ä¸æ˜¾ç¤º

**è§£å†³**ï¼š
1. æ‰“å¼€ Electron çª—å£çš„å¼€å‘è€…å·¥å…·ï¼ˆCtrl+Shift+Iï¼‰
2. æŸ¥çœ‹æ§åˆ¶å°æ˜¯å¦æœ‰é”™è¯¯
3. æ£€æŸ¥ `addBrowserMessage` å‡½æ•°æ˜¯å¦è¢«è°ƒç”¨
4. æ£€æŸ¥ DOM å…ƒç´ æ˜¯å¦å­˜åœ¨

### é—®é¢˜ 4ï¼šæ‰“åŒ…åè·¯å¾„é—®é¢˜

**ç—‡çŠ¶**ï¼šå¼€å‘ç¯å¢ƒæ­£å¸¸ï¼Œæ‰“åŒ…åä¸å·¥ä½œ

**è§£å†³**ï¼š
1. æ£€æŸ¥ `__dirname` å’Œ `process.resourcesPath` çš„å€¼
2. ç¡®ä¿ä½¿ç”¨æ­£ç¡®çš„è·¯å¾„åˆ¤æ–­é€»è¾‘
3. æ£€æŸ¥æ–‡ä»¶æ˜¯å¦è¢«æ‰“åŒ…

## ğŸ“ è°ƒè¯•å‘½ä»¤

### æŸ¥çœ‹ Electron æ—¥å¿—

Windows:
```powershell
# æŸ¥çœ‹åº”ç”¨æ—¥å¿—ï¼ˆå¦‚æœé…ç½®äº†æ—¥å¿—æ–‡ä»¶ï¼‰
Get-Content "C:\Users\YourName\AppData\Roaming\ElectronApp\logs\*.log"
```

### æµ‹è¯• WebSocket

åœ¨æµè§ˆå™¨æ§åˆ¶å°ï¼š
```javascript
// æµ‹è¯•è¿æ¥
const ws = new WebSocket('ws://127.0.0.1:8765/ws')
ws.onopen = () => {
  console.log('âœ… è¿æ¥æˆåŠŸ')
  ws.send(JSON.stringify({ type: 'ping' }))
}
ws.onmessage = (e) => console.log('ğŸ“¨ æ”¶åˆ°:', e.data)
ws.onerror = (e) => console.error('âŒ é”™è¯¯:', e)
```

### æµ‹è¯• IPC

åœ¨ Electron çª—å£çš„å¼€å‘è€…å·¥å…·æ§åˆ¶å°ï¼š
```javascript
// æ£€æŸ¥ API æ˜¯å¦å¯ç”¨
console.log('electronAPI:', window.electronAPI)

// æ‰‹åŠ¨è§¦å‘æ¶ˆæ¯ï¼ˆå¦‚æœ API å¯ç”¨ï¼‰
if (window.electronAPI) {
  window.electronAPI.onMessage((data) => {
    console.log('æµ‹è¯•æ¶ˆæ¯:', data)
  })
}
```

## ğŸ”§ é‡æ–°æ‰“åŒ…

å¦‚æœä¿®æ”¹äº†é…ç½®ï¼Œéœ€è¦é‡æ–°æ‰“åŒ…ï¼š

```bash
cd D:\admin\electron-app
# æ¸…ç†æ—§çš„æ„å»º
rm -rf release
# é‡æ–°æ‰“åŒ…
npm run build
```

ç„¶åé‡æ–°å®‰è£…å¹¶è¿è¡Œæ‰“åŒ…åçš„åº”ç”¨ã€‚

